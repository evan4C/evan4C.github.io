---
title: ä¸€æ–‡çœ‹æ‡‚vim
date: 2025-03-19
categories: [SWE]
tags: [vim, Linux, ä¸€æ–‡çœ‹æ‡‚]
---

> Throughout the time you're using vim, **make sure to look things up as you go**. If you ever get to a point where you're like:
>
> "Ohh, this is a really inefficient way of doing things, is there a better way?"
>
> the answer is almost always "YES", because vim is written by programmers and for programmers, so people ran same kind of issues and fixed them so you don't need to deal with these anymore.
>
> --- the missing semester of your CS education

Vim is a modal editor: it has different modes for inserting text vs manipulating text.

## Modal editing

| mode                           | purpose                                   | shortcut     |
| ------------------------------ | ----------------------------------------- | ------------ |
| Normal                         | for moving around a file and making edits | Esc          |
| Insert                         | for inserting text                        | I, i, A, a   |
| Replace                        | for replacing text                        | R            |
| Visual (plain, line, or block) | for selecting blocks of text              | v, V, Ctrl-v |
| Command-line                   | for running a command                     | :            |

## æ–‡ä»¶ç®¡ç†

åœ¨ Vim ä¸­ï¼ŒBuffersã€Tabs å’Œ Windows æ˜¯ä¸‰ç§ç®¡ç†æ–‡ä»¶çš„ä¸åŒæ–¹å¼ã€‚å®ƒä»¬çš„å…³ç³»å¦‚ä¸‹ï¼š

1. Buffer = æ–‡ä»¶ï¼ˆåå°æ•°æ®ï¼Œå¯èƒ½æœªæ˜¾ç¤ºï¼‰
2. Window = è§†å›¾ï¼ˆå…è®¸ä½ æŸ¥çœ‹ Buffersï¼‰
3. Tab = ä¸€ç»„ Windowsï¼ˆç”¨äºç»„ç»‡ä¸åŒä»»åŠ¡ï¼‰

å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ–¹å¼ï¼Ÿ

1. ç”¨ Buffers ğŸ“œï¼šå¦‚æœä½ æƒ³ä¸€æ¬¡æ€§æ‰“å¼€å¤šä¸ªæ–‡ä»¶ï¼Œä½†ä¸éœ€è¦åŒæ—¶æŸ¥çœ‹ã€‚
2. ç”¨ Windows ğŸªŸï¼šå¦‚æœä½ æƒ³å¹¶æ’æŸ¥çœ‹å¤šä¸ªæ–‡ä»¶ï¼Œæˆ–è€…åŒæ—¶ç¼–è¾‘å¤šä¸ªæ–‡ä»¶ã€‚
3. ç”¨ Tabs ğŸ·ï¸ï¼šå¦‚æœä½ åœ¨å¤„ç†å¤šä¸ªä»»åŠ¡ï¼ˆä¸åŒé¡¹ç›®ï¼‰ï¼Œå¹¶éœ€è¦å¯¹ä»»åŠ¡è¿›è¡Œåˆ†ç»„ã€‚

### Buffersï¼ˆç¼“å†²åŒºï¼‰

Buffer æ˜¯ Vim æ‰“å¼€çš„æ–‡ä»¶ï¼Œå³ä½¿å®ƒæ²¡æœ‰åœ¨çª—å£ä¸­æ˜¾ç¤ºï¼Œå®ƒä»ç„¶åœ¨å†…å­˜ä¸­å­˜åœ¨ï¼Œä½ å¯ä»¥æ‰“å¼€å¤šä¸ª Bufferï¼Œå¹¶åœ¨å®ƒä»¬ä¹‹é—´åˆ‡æ¢ã€‚å…³é—­çª—å£ä¸ä¼šå…³é—­ Bufferï¼Œé™¤éä½ æ‰‹åŠ¨åˆ é™¤å®ƒã€‚

Buffer ç›¸å…³å‘½ä»¤å¦‚ä¸‹ï¼š

| å‘½ä»¤            | ä½œç”¨                          |
| --------------- | ----------------------------- |
| :e filename     | æ‰“å¼€ filename å¹¶åŠ è½½åˆ° Buffer |
| :ls æˆ– :buffers | æ˜¾ç¤ºæ‰€æœ‰å·²åŠ è½½çš„ Buffer       |
| :bn(ext)        | åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ª Buffer           |
| :bp(revious)    | åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ª Buffer           |
| :bd(elete)      | å…³é—­å½“å‰ Bufferï¼ˆä¸å½±å“çª—å£ï¼‰ |

### Tabsï¼ˆæ ‡ç­¾é¡µï¼‰

Tabs ç›¸å…³å‘½ä»¤å’Œå¿«æ·é”®å¦‚ä¸‹ï¼š

| å‘½ä»¤                | ä½œç”¨                     |
| ------------------- | ------------------------ |
| :tabnew             | æ–°å»ºä¸€ä¸ªç©ºçš„ Tab         |
| :tabe(dit) filename | åœ¨æ–° Tab ä¸­æ‰“å¼€ filename |
| gt/gT               | åˆ‡æ¢åˆ°ä¸‹/ä¸Šä¸€ä¸ª Tab      |
| :tabn(ext)          | åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ª Tab         |
| :tabp(revious)      | åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ª Tab         |
| :tabfirst           | è·³åˆ°ç¬¬ä¸€ä¸ª Tab           |
| :tablast            | è·³åˆ°æœ€åä¸€ä¸ª Tab         |
| :tabn N             | åˆ‡æ¢åˆ°ç¬¬ N ä¸ª Tab        |
| :tabclose           | å…³é—­å½“å‰ Tab             |
| :tabclose N         | å…³é—­ç¬¬ N ä¸ª Tab          |

### Windowsï¼ˆçª—å£ï¼‰

Windows å…è®¸ä½ åŒæ—¶æŸ¥çœ‹å¤šä¸ª Buffersã€‚ä½ å¯ä»¥æ°´å¹³æˆ–å‚ç›´åˆ†å‰²çª—å£ï¼Œæ¯ä¸ªçª—å£å¯ä»¥æ˜¾ç¤ºç›¸åŒæˆ–ä¸åŒçš„ Bufferã€‚å…³é—­ä¸€ä¸ªçª—å£ä¸ä¼šå½±å“ Bufferï¼ŒBuffer ä»ç„¶å­˜åœ¨ã€‚

Window ç›¸å…³å‘½ä»¤å’Œå¿«æ·é”®å¦‚ä¸‹ï¼š
| å‘½ä»¤ | ä½œç”¨ |
| ------------------- | ---------------------------------------------- |
| :sp(lit) filename1 | æ°´å¹³åˆ†å±æ‰“å¼€ filename1 |
| :vsp(lit) filename2 | å‚ç›´åˆ†å±æ‰“å¼€ filename2 |
| :new | æ°´å¹³æ–°å»ºä¸€ä¸ªç©ºçª—å£ |
| :vnew | å‚ç›´æ–°å»ºä¸€ä¸ªç©ºçª—å£ |
| :q | å…³é—­å½“å‰çª—å£ï¼ˆå¦‚æœæ˜¯æœ€åä¸€ä¸ªçª—å£ï¼Œåˆ™å…³é—­ Vimï¼‰ |
| :close | å…³é—­å½“å‰çª—å£ï¼Œä½†ä¸ä¼šå…³é—­ Vim |
| Ctrl + w w | åœ¨çª—å£ä¹‹é—´å¾ªç¯åˆ‡æ¢ |
| Ctrl + w h/l/j/k | åˆ‡æ¢åˆ°å·¦/å³/ä¸‹/ä¸Šçª—å£ |
| Ctrl + w = | è®©æ‰€æœ‰çª—å£ç­‰å®½ç­‰é«˜ |
| Ctrl + w - | å‡å°å½“å‰çª—å£é«˜åº¦ |
| Ctrl + w + | å¢åŠ å½“å‰çª—å£é«˜åº¦ |
| Ctrl + w < | å‡å°å½“å‰çª—å£å®½åº¦ |
| Ctrl + w > | å¢åŠ å½“å‰çª—å£å®½åº¦ |

### å¿«é€Ÿæ‰“å¼€å¤šä¸ªæ–‡ä»¶

å¦‚æœä½ æƒ³ä¸€æ¬¡æ€§æ‰“å¼€å¤šä¸ªæ–‡ä»¶ï¼Œå¹¶ç”¨ Tab æˆ– Split æ–¹å¼æ˜¾ç¤ºï¼š

```bash
vim -p file1.txt file2.txt file3.txt   # åœ¨ä¸åŒ Tab é‡Œæ‰“å¼€
vim -O file1.txt file2.txt              # å‚ç›´åˆ†å±æ‰“å¼€
vim -o file1.txt file2.txt              # æ°´å¹³åˆ†å±æ‰“å¼€
```

## Common commands in Command-line

| command           | purpose                       |
| ----------------- | ----------------------------- |
| :w                | save (â€œwriteâ€)                |
| :q                | quit (close window)           |
| :e {name of file} | open file for editing         |
| :ls               | show open buffers             |
| :help {topic}     | open help                     |
| :help :w          | opens help for the :w command |
| :help w           | opens help for the w movement |

## Vim's interface is a programming language

**Keystrokes (with mnemonic names) are commands, and these commands compose.**

### Movement

Movements in Vim are also called â€œnounsâ€, because they refer to chunks of text.

| **ç±»åˆ«**     | **å‘½ä»¤**                                      | **è¯´æ˜**                                   |
| ------------ | --------------------------------------------- | ------------------------------------------ |
| **åŸºæœ¬ç§»åŠ¨** | `h` / `j` / `k` / `l`                         | å·¦ / ä¸‹ / ä¸Š / å³                          |
| **å•è¯ç§»åŠ¨** | `w` / `b` / `e`                               | ä¸‹ä¸€ä¸ªå•è¯ / å•è¯å¼€å¤´ / å•è¯ç»“å°¾           |
| **è¡Œå†…ç§»åŠ¨** | `0` / `^` / `$`                               | è¡Œé¦– / ç¬¬ä¸€ä¸ªéç©ºå­—ç¬¦ / è¡Œå°¾               |
| **å±å¹•ç§»åŠ¨** | `H` / `M` / `L`                               | å±å¹•é¡¶éƒ¨ / å±å¹•ä¸­éƒ¨ / å±å¹•åº•éƒ¨             |
| **æ»šåŠ¨**     | `Ctrl-u` / `Ctrl-d`                           | å‘ä¸Šæ»šåŠ¨ / å‘ä¸‹æ»šåŠ¨                        |
| **æ–‡ä»¶ç§»åŠ¨** | `gg` / `G`                                    | è·³è½¬åˆ°æ–‡ä»¶å¼€å¤´ / è·³è½¬åˆ°æ–‡ä»¶ç»“å°¾            |
| **è¡Œå·è·³è½¬** | `:{number}` / `{number}G`                     | è·³è½¬åˆ°ç¬¬ `{number}` è¡Œ                     |
| **å…¶ä»–**     | `%`                                           | åŒ¹é…å¯¹åº”ç¬¦å·ï¼Œä¾‹å¦‚å·¦å³æ‹¬å·                 |
| **æŸ¥æ‰¾**     | `f{å­—ç¬¦}` / `t{å­—ç¬¦}` / `F{å­—ç¬¦}` / `T{å­—ç¬¦}` | æŸ¥æ‰¾(find)/è·³è½¬(to)åˆ°æŒ‡å®šå­—ç¬¦ï¼ˆå‘å‰/å‘åï¼‰ |
| **æŸ¥æ‰¾åŒ¹é…** | `,` / `;`                                     | åœ¨åŒ¹é…é¡¹é—´å¯¼èˆª                             |
| **æœç´¢**     | `/{æ­£åˆ™è¡¨è¾¾å¼}`                               | è¿›è¡Œæœç´¢                                   |
| **æœç´¢å¯¼èˆª** | `n` / `N`                                     | åœ¨åŒ¹é…é¡¹é—´å‰è¿› / åé€€                      |

## Edit

Vimâ€™s editing commands are also called â€œverbsâ€, because verbs act on nouns.

| **ç±»åˆ«**       | **å‘½ä»¤**           | **è¯´æ˜**                                                |
| -------------- | ------------------ | ------------------------------------------------------- |
| **æ’å…¥æ¨¡å¼**   | `i`                | è¿›å…¥æ’å…¥æ¨¡å¼                                            |
| **æ–°å»ºè¡Œ**     | `o` / `O`          | åœ¨å½“å‰è¡Œä¸‹æ–¹ / ä¸Šæ–¹æ’å…¥æ–°è¡Œ                             |
| **åˆ é™¤**       | `d{motion}`        | åˆ é™¤ `{motion}` æŒ‡å®šèŒƒå›´                                |
| **ç¤ºä¾‹**       | `dw` / `d$` / `d0` | åˆ é™¤å•è¯ / åˆ é™¤è‡³è¡Œå°¾ / åˆ é™¤è‡³è¡Œé¦–                      |
| **ä¿®æ”¹**       | `c{motion}`        | ä¿®æ”¹ `{motion}` æŒ‡å®šèŒƒå›´ï¼ˆç›¸å½“äº `d{motion}` åè·Ÿ `i`ï¼‰ |
| **ç¤ºä¾‹**       | `cw`               | ä¿®æ”¹å•è¯                                                |
| **å­—ç¬¦åˆ é™¤**   | `x`                | åˆ é™¤å½“å‰å­—ç¬¦ï¼ˆç­‰åŒäº `dl`ï¼‰                             |
| **å­—ç¬¦æ›¿æ¢**   | `s`                | æ›¿æ¢å½“å‰å­—ç¬¦ï¼ˆç­‰åŒäº `cl`ï¼‰                             |
| **åˆ é™¤/ä¿®æ”¹**  | `d` / `c`          | åœ¨å¯è§†æ¨¡å¼ä¸‹åˆ é™¤ / ä¿®æ”¹é€‰ä¸­æ–‡æœ¬                         |
| **æ’¤é”€/é‡åš**  | `u` / `<C-r>`      | æ’¤é”€ / é‡åš                                             |
| **å¤åˆ¶/ç²˜è´´**  | `y` / `p`          | å¤åˆ¶ï¼ˆyankï¼‰/ ç²˜è´´                                      |
| **å¤§å°å†™åˆ‡æ¢** | `~`                | åˆ‡æ¢å½“å‰å­—ç¬¦å¤§å°å†™                                      |

## Count

You can combine nouns and verbs with a count, which will perform a given action a number of times.

| **å‘½ä»¤** | **è¯´æ˜**          |
| -------- | ----------------- |
| `3w`     | å‘å‰ç§»åŠ¨ 3 ä¸ªå•è¯ |
| `5j`     | å‘ä¸‹ç§»åŠ¨ 5 è¡Œ     |
| `7dw`    | åˆ é™¤ 7 ä¸ªå•è¯     |

### Modifiers

You can use modifiers to change the meaning of a noun.

- `i`ï¼ˆinner / insideï¼‰ï¼šæ“ä½œæ‹¬å·ã€å¼•å·ç­‰å†…éƒ¨å†…å®¹ï¼Œä¸åŒ…æ‹¬å¤–å›´ç¬¦å·ã€‚
- `a`ï¼ˆaroundï¼‰ï¼šæ“ä½œæ‹¬å·ã€å¼•å·ç­‰å†…éƒ¨å†…å®¹ï¼Œå¹¶åŒ…æ‹¬å¤–å›´ç¬¦å·ã€‚

| **å‘½ä»¤** | **è¯´æ˜**                           |
| -------- | ---------------------------------- |
| `ci(`    | ä¿®æ”¹å½“å‰åœ†æ‹¬å·å†…çš„å†…å®¹             |
| `ci[`    | ä¿®æ”¹å½“å‰æ–¹æ‹¬å·å†…çš„å†…å®¹             |
| `da'`    | åˆ é™¤å•å¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬å•å¼•å· |

## Customize Vim

Vim is customized through a plain-text configuration file in `~/.vimrc`.

There are tons of plugins for extending Vim. Contrary to outdated advice that you might find on the internet, you do not need to use a plugin manager for Vim.

Instead, you can use the built-in package management system. Simply create the directory `~/.vim/pack/vendor/start/`, and put plugins in there (e.g. `via git clone`).

Here are some of our favorite plugins:

- ctrlp.vim: fuzzy file finder
- ack.vim: code search
- nerdtree: file explorer
- vim-easymotion: magic motions

## Advanced Vim

### Use Vim-mode in other programs

- Shell: If youâ€™re a Bash user, use set `-o vi`. If you use Zsh, `bindkey -v`. Additionally, no matter what shell you use, you can export `EDITOR=vim`. This is the environment variable used to decide which editor is launched when a program wants to start an editor.

### Search and replace

`:s` (substitute) command.

| å‘½ä»¤                | ä½œç”¨                                    |
| ------------------- | --------------------------------------- |
| `:s/foo/bar/`       | æ›¿æ¢å½“å‰è¡Œç¬¬ä¸€ä¸ª foo ä¸º bar             |
| `:s/foo/bar/g`      | æ›¿æ¢å½“å‰è¡Œæ‰€æœ‰ foo ä¸º bar               |
| `:%s/foo/bar/g`     | æ›¿æ¢æ•´ä¸ªæ–‡ä»¶æ‰€æœ‰ foo ä¸º bar             |
| `:3,5s/foo/bar/g`   | æ›¿æ¢ç¬¬ 3 åˆ° 5 è¡Œçš„ foo ä¸º bar           |
| `:.,$s/foo/bar/g`   | ä»å½“å‰è¡Œ`.`åˆ°æœ€åä¸€è¡Œ`,`æ›¿æ¢ foo ä¸º bar |
| `:%s/foo/bar/gc`    | äº¤äº’å¼ç¡®è®¤æ›¿æ¢                          |
| `:%s/foo/bar/gi`    | å¿½ç•¥å¤§å°å†™æ›¿æ¢                          |
| `:%s/\<foo\>/bar/g` | ä»…åŒ¹é…å®Œæ•´å•è¯ foo                      |
| `:%s/foo/PRE-&/g`   | åœ¨åŒ¹é…é¡¹å‰åŠ  PRE-                       |
| `:&&`               | é‡å¤ä¸Šä¸€æ¬¡ :s å‘½ä»¤                      |

best practices:

```bash
# ä¸ºå½“å‰è¡Œå’Œ218ä¹‹é—´çš„æ‰€æœ‰:å¼€å¤´çš„å‘½ä»¤å‰åæ·»åŠ `
:.,218s/(:[\S]*)/`\1`

```

### Macros

- `q{character}` to start recording a macro in register `{character}`
- `q` to stop recording
- `@{character}` replays the macro
- Macro execution stops on error
- {number}`@{character}` executes a macro {number} times

## Useful tips

### A demo

Watch a practice demo in the [missing semester lecture](https://missing.csail.mit.edu/2020/editors/) from 37:35.

- ä½¿ç”¨`.`å¿«é€Ÿé‡å¤ä¸Šæ¬¡çš„æ“ä½œ
- ä½¿ç”¨ vim golf ç»ƒä¹  vim å‘½ä»¤

### å¤šè¡Œæ‰¹é‡ç¼–è¾‘æ–‡æœ¬

- æŒ‰ Ctrl-v è¿›å…¥ Visual Block æ¨¡å¼ï¼Œé€‰æ‹©å¤šè¡Œã€‚
- æ‰¹é‡æ’å…¥ï¼šæŒ‰ Iï¼ˆå¤§å†™ iï¼‰ï¼Œè¾“å…¥æ–‡æœ¬ï¼Œç„¶åæŒ‰ Escï¼ŒVim ä¼šåœ¨æ‰€æœ‰é€‰ä¸­çš„è¡Œæ’å…¥ç›¸åŒçš„æ–‡æœ¬ã€‚
- æ‰¹é‡è¿½åŠ ï¼šæŒ‰ Aï¼ˆå¤§å†™ aï¼‰ï¼Œè¾“å…¥æ–‡æœ¬ï¼Œç„¶åæŒ‰ Escï¼ŒVim ä¼šåœ¨æ‰€æœ‰é€‰ä¸­çš„è¡Œæœ«å°¾è¿½åŠ ç›¸åŒçš„æ–‡æœ¬ã€‚
- æ‰¹é‡åˆ é™¤ï¼šæŒ‰ d åˆ é™¤é€‰ä¸­çš„å—ã€‚

## Resources

1. [Vim Tips Wiki](https://vim.fandom.com/wiki/Vim_Tips_Wiki)
2. [Vim Golf](https://www.vimgolf.com)
3. [Vi/Vim Stack Exchange](https://vi.stackexchange.com)
4. [missing semester of your CS education](https://missing.csail.mit.edu/2020/editors/)
